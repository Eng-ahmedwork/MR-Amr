/* Obfuscated by J2TEAM.org */const _0x32e985 = _0x3ce1; (function (_0x443a4a, _0x41c510) { const _0x24bb70 = _0x3ce1, _0x326047 = _0x443a4a(); while (!![]) { try { const _0x1c547f = parseInt(_0x24bb70(0x24b)) / 0x1 + parseInt(_0x24bb70(0x2ff)) / 0x2 + -parseInt(_0x24bb70(0x19d)) / 0x3 * (-parseInt(_0x24bb70(0x1bd)) / 0x4) + parseInt(_0x24bb70(0x2ea)) / 0x5 + parseInt(_0x24bb70(0x250)) / 0x6 * (parseInt(_0x24bb70(0x1e6)) / 0x7) + parseInt(_0x24bb70(0x1fc)) / 0x8 + -parseInt(_0x24bb70(0x1f2)) / 0x9 * (parseInt(_0x24bb70(0x2c8)) / 0xa); if (_0x1c547f === _0x41c510) break; else _0x326047['push'](_0x326047['shift']()); } catch (_0x57e67d) { _0x326047['push'](_0x326047['shift']()); } } }(_0x4b05, 0x76c56)); let students = [], currentSection = 'dashboard'; function updateStorageIndicator() { const _0x19453a = _0x3ce1, _0x553bd4 = new Blob([JSON[_0x19453a(0x22e)](students)])[_0x19453a(0x271)], _0x5a9278 = (_0x553bd4 / 0x400)[_0x19453a(0x23f)](0x2), _0x116a0c = 0x400 * 0x400, _0x51130e = Math['min'](_0x5a9278 / _0x116a0c * 0x64, 0x64), _0x4848fb = document[_0x19453a(0x299)](_0x19453a(0x1fa)), _0x41f5df = document[_0x19453a(0x299)](_0x19453a(0x1c3)), _0x380d3a = document[_0x19453a(0x299)](_0x19453a(0x23e)); if (_0x4848fb) _0x4848fb[_0x19453a(0x26b)] = _0x5a9278 + '\x20KB'; if (_0x41f5df) _0x41f5df[_0x19453a(0x1f1)][_0x19453a(0x26d)] = _0x51130e + '%'; if (_0x380d3a) { const _0x5c3847 = ((_0x116a0c - _0x5a9278) / 0x400)[_0x19453a(0x23f)](0x2); _0x380d3a[_0x19453a(0x26b)] = _0x5c3847 + _0x19453a(0x1b3); } } async function saveToFirebase() { const _0x5ca9b5 = _0x3ce1; try { await db[_0x5ca9b5(0x2bd)](_0x5ca9b5(0x2ca))['set'](students), updateStorageIndicator(); } catch (_0x1d759f) { console[_0x5ca9b5(0x288)](_0x5ca9b5(0x204), _0x1d759f); } } function initDataSync() { const _0xd236f9 = _0x3ce1; db['ref'](_0xd236f9(0x2ca))['on'](_0xd236f9(0x2a8), _0x1deb4d => { const _0xb2746f = _0xd236f9, _0x158c3a = _0x1deb4d['val'](); students = _0x158c3a || [], updateStorageIndicator(); if (currentSection === _0xb2746f(0x2ae)) displayStudentList(); if (currentSection === _0xb2746f(0x1a3)) updateDashboardStats(); }); } let waWindowReference = null; const Modal = { get 'elements'() { const _0x22af96 = _0x3ce1; return { 'overlay': document[_0x22af96(0x20c)](_0x22af96(0x1cf)), 'title': document[_0x22af96(0x20c)](_0x22af96(0x1ce)), 'message': document['getElementById'](_0x22af96(0x196)), 'actions': document[_0x22af96(0x20c)]('modal-actions') }; }, 'show'(_0x315d9e, _0x4d9782, _0xfb9e76) { return new Promise(_0x3924e0 => { const _0xf279f8 = _0x3ce1, _0xb80356 = this[_0xf279f8(0x236)]; _0xb80356[_0xf279f8(0x25c)][_0xf279f8(0x26b)] = _0x315d9e, _0xb80356[_0xf279f8(0x1b1)][_0xf279f8(0x1ba)] = _0x4d9782[_0xf279f8(0x21f)](/\n/g, '<br>'), _0xb80356['actions'][_0xf279f8(0x1ba)] = '', _0xfb9e76[_0xf279f8(0x19f)](_0x17e463 => { const _0x14016f = _0xf279f8, _0x2b4da6 = document[_0x14016f(0x254)](_0x14016f(0x1c4)); _0x2b4da6['textContent'] = _0x17e463['text'], _0x2b4da6[_0x14016f(0x2b7)] = 'modal-btn\x20' + (_0x17e463[_0x14016f(0x2f9)] ? _0x14016f(0x2c6) : _0x14016f(0x22b)), _0x2b4da6[_0x14016f(0x1ed)] = () => { const _0x6f4f35 = _0x14016f; this[_0x6f4f35(0x192)](), _0x3924e0(_0x17e463['value']); }, _0xb80356[_0x14016f(0x22f)]['appendChild'](_0x2b4da6); }), _0xb80356[_0xf279f8(0x1d8)][_0xf279f8(0x1ed)] = _0x499d51 => { const _0x42eea1 = _0xf279f8; _0x499d51['target'] === _0xb80356[_0x42eea1(0x1d8)] && (this['close'](), _0x3924e0(!![])); }, _0xb80356[_0xf279f8(0x1d8)][_0xf279f8(0x20e)]['add']('active'); }); }, 'close'() { const _0x2394c7 = _0x3ce1; this['elements'][_0x2394c7(0x1d8)][_0x2394c7(0x20e)]['remove'](_0x2394c7(0x1bf)); }, 'alert'(_0x15c57d, _0x5ac4e6) { return this['show'](_0x15c57d, _0x5ac4e6, [{ 'text': 'OK', 'value': !![], 'primary': !![] }]); }, 'confirm'(_0x57b66f, _0x407b09) { const _0x63e295 = _0x3ce1; return this[_0x63e295(0x2eb)](_0x57b66f, _0x407b09, [{ 'text': 'Yes', 'value': !![], 'primary': !![] }, { 'text': _0x63e295(0x1df), 'value': ![], 'primary': ![] }]); } }; document[_0x32e985(0x2ad)]('DOMContentLoaded', () => { initLogin(), initNavigation(), initDataSync(), renderDashboard(), initTheme(); }); function initLogin() { const _0x272712 = _0x32e985, _0x3bc5d7 = document[_0x272712(0x20c)](_0x272712(0x286)), _0xa1bbd1 = document['getElementById'](_0x272712(0x1d9)), _0x3ed3d8 = document[_0x272712(0x20c)](_0x272712(0x2ee)), _0x5eefcf = document['getElementById'](_0x272712(0x258)), _0x34f815 = document[_0x272712(0x20c)](_0x272712(0x1a9)), _0x527dc6 = document[_0x272712(0x299)]('.app-container'); if (!_0x3bc5d7) return; _0x3bc5d7[_0x272712(0x2ad)](_0x272712(0x1a8), _0x2aadf7 => { const _0x20bdef = _0x272712; _0x2aadf7['preventDefault'](); const _0x370c1e = _0xa1bbd1[_0x20bdef(0x2a8)][_0x20bdef(0x2d5)](), _0x2ebde9 = _0x3ed3d8[_0x20bdef(0x2a8)][_0x20bdef(0x2d5)](); _0x370c1e === 'amr' && _0x2ebde9 === _0x20bdef(0x2d6) ? (_0x34f815['style']['display'] = _0x20bdef(0x252), _0x527dc6['style'][_0x20bdef(0x193)] = _0x20bdef(0x217)) : (_0x5eefcf[_0x20bdef(0x1f1)][_0x20bdef(0x193)] = _0x20bdef(0x2bb), _0xa1bbd1['value'] = '', _0x3ed3d8[_0x20bdef(0x2a8)] = '', _0xa1bbd1['focus']()); }); } function initNavigation() { const _0x2fcc34 = _0x32e985, _0x32a116 = document[_0x2fcc34(0x253)](_0x2fcc34(0x294)); _0x32a116['forEach'](_0x132693 => { _0x132693['addEventListener']('click', _0x328549 => { const _0x125719 = _0x3ce1; _0x328549[_0x125719(0x2c9)](); const _0x3dc2a6 = _0x132693['getAttribute'](_0x125719(0x1f9)); _0x32a116['forEach'](_0x667c48 => _0x667c48[_0x125719(0x20e)]['remove'](_0x125719(0x1bf))), _0x132693[_0x125719(0x20e)][_0x125719(0x1a7)](_0x125719(0x1bf)), navigateTo(_0x3dc2a6), window[_0x125719(0x25f)] <= 0x300 && document['getElementById']('sidebar')?.['classList'][_0x125719(0x1dd)](_0x125719(0x227)); }); }), document[_0x2fcc34(0x20c)](_0x2fcc34(0x1f8))?.['addEventListener']('click', () => { const _0x409ab1 = _0x2fcc34; document['getElementById'](_0x409ab1(0x211))[_0x409ab1(0x20e)][_0x409ab1(0x25a)](_0x409ab1(0x227)); }); } function navigateTo(_0xb82daf) { const _0x8aced7 = _0x32e985; currentSection = _0xb82daf; const _0x530bc8 = document[_0x8aced7(0x20c)](_0x8aced7(0x23a)), _0x5de3d8 = document[_0x8aced7(0x20c)](_0x8aced7(0x2cb)), _0x381110 = document['getElementById'](_0x8aced7(0x276)); if (_0x381110) _0x381110[_0x8aced7(0x1ba)] = ''; switch (_0xb82daf) { case _0x8aced7(0x1a3): _0x5de3d8[_0x8aced7(0x26b)] = _0x8aced7(0x2c5), renderDashboard(); break; case _0x8aced7(0x2ca): _0x5de3d8[_0x8aced7(0x26b)] = _0x8aced7(0x27e), renderStudentsSection(); break; case _0x8aced7(0x2ae): _0x5de3d8[_0x8aced7(0x26b)] = _0x8aced7(0x268), renderStudentListSection(); break; case _0x8aced7(0x1c8): _0x5de3d8['textContent'] = _0x8aced7(0x194), renderPerformanceSection(); break; case 'reports': _0x5de3d8[_0x8aced7(0x26b)] = _0x8aced7(0x2fa), renderReportsSection(); break; } } function _0x4b05() { const _0x2f002f = ['previousElementSibling', '\x27)\x22\x20class=\x22btn\x22\x20style=\x22background:\x20var(--border-color);\x22>Cancel</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '\x27,\x20this.value)\x22\x20style=\x22padding:\x204px\x208px;\x20width:\x20120px;\x20font-size:\x200.85rem;\x20border-radius:\x208px;\x20border:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22all\x22\x20', '1824748BCeEaM', 'getChart', 'close', 'display', '\x20Attendance\x20&\x20Grades\x20&\x20Fees', 'split', 'modal-message', 'Exam', 'destroy', 'from', '\x20في\x20مادة\x20الـ\x20Maths.\x0aتحت\x20إشراف\x20\x0aالبشمهندس\x20:\x20عمرو\x20وحيد', 'grades', 'DateTimeFormat', '459495AdeoyR', 'toLocaleDateString', 'forEach', '❌\x20Not\x20Sent', 'some', 'Success', 'dashboard', 'attendance-feedback', '#4f46e5', '</option>', 'add', 'submit', 'login-overlay', 'join', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22\x20style=\x22margin-bottom:\x201.5rem;\x20display:\x20flex;\x20align-items:\x20center;\x20gap:\x201rem;\x20flex-wrap:\x20wrap;\x20background:\x20var(--bg-card);\x20border:\x201px\x20solid\x20var(--primary-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-weight:\x20bold;\x20color:\x20var(--primary-color);\x22><i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20Select\x20Date\x20for\x20Records:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22date\x22\x20id=\x22performance-date\x22\x20class=\x22form-control\x22\x20style=\x22width:\x20auto;\x20padding:\x200.5rem\x201rem;\x20border-radius:\x208px;\x20border:\x201px\x20solid\x20var(--border-color);\x22\x20value=\x22', 'type', 'Wed', 'body', 'btn-primary', '>Prep1</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22prep2\x22\x20', 'message', 'result', '\x20MB\x20', 'Imported', 'length', '2.\x20Press\x20(Ctrl\x20+\x20V)\x20inside\x20the\x20chat\x20to\x20paste\x20and\x20send\x20the\x20image.\x0a\x0a', 'attendanceChart', 'prep3', '#stat-today-attendance', 'innerHTML', '<i\x20class=\x22fas\x20fa-moon\x22></i>\x20<span>Dark\x20Mode</span>', 'score', '20xTKvoc', 'padStart', 'active', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'student-age', 'pdf-attendance-count', '.sidebar-storage\x20.progress', 'button', 'This\x20ID\x20already\x20exists\x20for\x20another\x20student.\x0aPlease\x20choose\x20a\x20different\x20ID.', '>Sec3</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Phone\x20Number</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22tel\x22\x20id=\x22edit-phone\x22\x20value=\x22', '>Prep2</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22prep3\x22\x20', 'performance', '\x22></i>\x20', '</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x201rem;\x20display:\x20flex;\x20gap:\x200.5rem;\x20justify-content:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22viewStudentProfile(\x27', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22\x20style=\x22grid-column:\x20span\x202;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-bottom:\x201rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin:\x200;\x22>History\x20&\x20Grades\x20(Newest\x20First)</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.85rem;\x20font-weight:\x20600;\x20color:\x20var(--text-muted);\x22>Month:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22profile-month-filter\x22\x20onchange=\x22viewStudentProfile(\x27', 'Attendance', 'setItem', 'modal-title', 'custom-modal', 'Name', '\x20EGP\x20registered\x20for\x20student\x20', 'Import\x20Error:', 'confirm', 'parse', 'json_to_sheet', 'Data\x20updated\x20successfully!', 'student-form', 'overlay', 'login-username', 'fee-note', 'File\x20is\x20empty\x20or\x20invalid.', 'en-GB', 'remove', 'grade-name-preview', 'Cancel', '<i\x20class=\x22fas\x20fa-sun\x22></i>\x20<span>Light\x20Mode</span>', 'readAsArrayBuffer', 'push', 'search-student', 'Students', '?\x0aThis\x20action\x20cannot\x20be\x20undone.', '49osIsOL', 'مرحباً،\x20تقرير\x20أداء\x20الطالب/ة\x20', 'Photo', 'Failed\x20to\x20read\x20file.\x20Please\x20ensure\x20it\x20is\x20a\x20valid\x20Excel\x20file.', 'round', 'This\x20will\x20add/update\x20', 'Please\x20enter\x20a\x20valid\x20Student\x20ID', 'onclick', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20style=\x22border-bottom:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x201rem;\x20font-weight:\x20bold;\x22>', 'exam-type', '_grades', 'style', '2754dRrHGF', '!cols', 'attendance', 'focus', 'guardianPhone', 'utils', 'menu-toggle', 'data-section', '.storage-info\x20span:last-child', '</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22display:\x20flex;\x20align-items:\x20flex-end;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22btn\x20btn-primary\x22\x20style=\x22flex:\x201;\x22>Save\x20Changes</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20onclick=\x22viewStudentProfile(\x27', '274864OziEan', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'payments', '1.\x20WhatsApp\x20will\x20open\x20now.\x0a', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-muted);\x22>No\x20students\x20registered\x20currently.</p>', '</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20right;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x200.25rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20Educational\x20Stage\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x200.5rem;\x20padding:\x200.3rem\x200.5rem;\x20background:\x20var(--bg-color);\x20border-radius:\x20var(--radius);\x20border:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22width:\x2026px;\x20height:\x2026px;\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20background:\x20rgba(79,\x2070,\x20229,\x200.1);\x20color:\x20var(--primary-color);\x20border-radius:\x206px;\x20font-size:\x200.8rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-graduation-cap\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x200.65rem;\x20color:\x20var(--text-muted);\x20margin:\x200;\x22>Stage</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20700;\x20margin:\x200;\x20font-size:\x200.85rem;\x22>', 'getContext', 'Firebase\x20Save\x20Error:', 'light', 'student-id', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x202px;\x20white-space:\x20nowrap;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20#10b981;\x20font-weight:\x20bold;\x22>', 'profile', 'location', 'Tue', 'Saved', 'getElementById', 'Sun', 'classList', 'click', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20style=\x22font-size:\x201.5rem;\x20margin-bottom:\x200.25rem;\x22>', 'sidebar', '.filter-btn', '✅\x20Sent', '<span\x20style=\x22font-size:0.75rem;\x20color:var(--text-muted);\x20margin-right:5px;\x20border-right:\x201px\x20solid\x20var(--border-color);\x20padding-right:5px;\x22>', 'alert', 'includes', 'flex', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22table-responsive\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table\x20style=\x22width:\x20100%;\x20border-collapse:\x20collapse;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20style=\x22text-align:\x20left;\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x201rem;\x22>Code</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x201rem;\x22>Name</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x201rem;\x22>Phone</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x201rem;\x22>Stage</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x201rem;\x22>Actions</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x20students\x20imported\x20successfully!', 'pdf-report-note', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20start;\x20gap:\x200.5rem;\x20padding:\x200.6rem\x200.5rem;\x20background:\x20rgba(245,\x20158,\x2011,\x200.05);\x20border-radius:\x20var(--radius);\x20border:\x201px\x20dashed\x20#f59e0b;\x20margin-top:\x200.5rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22width:\x2026px;\x20height:\x2026px;\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20background:\x20rgba(245,\x20158,\x2011,\x200.1);\x20color:\x20#f59e0b;\x20border-radius:\x206px;\x20font-size:\x200.8rem;\x20flex-shrink:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-sticky-note\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20right;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x200.65rem;\x20color:\x20var(--text-muted);\x20margin:\x200;\x22>Notes</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20600;\x20margin:\x200;\x20font-size:\x200.8rem;\x20line-height:\x201.4;\x22>', 'all', 'Error', 'Confirm\x20Import', 'replace', '</span>\x20<span\x20style=\x22color:\x20#ef4444;\x22>ج.م</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x22\x20style=\x22color:\x20#f59e0b;\x20margin-right:\x205px;\x20cursor:\x20help;\x22></i>', 'stat-total-expenses', '&text=', 'fee-amount', 'filter-stage', 'Mon', 'open', 'fa-bolt', '\x22\x20placeholder=\x22https://example.com/image.jpg\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22grid-column:\x20span\x202;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Notes</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22edit-note\x22\x20placeholder=\x22Add\x20notes\x20here...\x22\x20style=\x22width:\x20100%;\x20min-height:\x2080px;\x20padding:\x200.8rem;\x20border-radius:\x20var(--radius);\x20border:\x201px\x20solid\x20var(--border-color);\x20background:\x20var(--bg-color);\x20color:\x20var(--text-color);\x20font-family:\x20inherit;\x20resize:\x20vertical;\x22>', 'reportLog', 'modal-btn-secondary', 'pdf-student-photo', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x2010px;\x20border:\x201px\x20solid\x20#ddd;\x20text-align:\x20center;\x22>', 'stringify', 'actions', 'map', 'Image\x20Error:', 'An\x20error\x20occurred\x20while\x20creating\x20the\x20image.', 'student-photo-url', 'getDate', 'report-note', 'elements', 'theme-toggle', 'max', 'student-list-container', 'content-area', 'data-theme', 'student-note', 'student-score', '.storage-free', 'toFixed', 'stat-avg-score', 'quiz', 'src', 'random', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Add\x20New\x20Student</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22student-form\x22\x20class=\x22grid-3\x22\x20style=\x22margin-top:\x201rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Student\x20Code</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20id=\x22student-id\x22\x20required\x20placeholder=\x223-4\x20digits\x22\x20maxlength=\x224\x22\x20pattern=\x22[0-9]{3,4}\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Student\x20Name</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20id=\x22student-name\x22\x20required\x20placeholder=\x22Full\x20Name\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Age</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20id=\x22student-age\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Stage</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22student-stage\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22\x22>Select\x20Stage...</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22prep1\x22>Prep1</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22prep2\x22>Prep2</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22prep3\x22>Prep3</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22Sec1\x22>Sec1</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22Sec2\x22>Sec2</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22Sec3\x22>Sec3</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Phone\x20Number</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22tel\x22\x20id=\x22student-phone\x22\x20required\x20maxlength=\x2211\x22\x20minlength=\x2211\x22\x20pattern=\x22[0-9]{11}\x22\x20placeholder=\x2201XXXXXXXXX\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Parent\x20Phone</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22tel\x22\x20id=\x22guardian-phone\x22\x20required\x20maxlength=\x2211\x22\x20minlength=\x2211\x22\x20pattern=\x22[0-9]{11}\x22\x20placeholder=\x2201XXXXXXXXX\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Photo\x20URL</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22student-photo-url\x22\x20placeholder=\x22https://example.com/image.jpg\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22grid-column:\x20span\x202;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Notes</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22student-note\x22\x20placeholder=\x22Add\x20notes\x20here...\x22\x20style=\x22width:\x20100%;\x20min-height:\x2080px;\x20padding:\x200.8rem;\x20border-radius:\x20var(--radius);\x20border:\x201px\x20solid\x20var(--border-color);\x20background:\x20var(--bg-color);\x20color:\x20var(--text-color);\x20font-family:\x20inherit;\x20resize:\x20vertical;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22display:\x20flex;\x20align-items:\x20flex-end;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22btn\x20btn-primary\x22\x20style=\x22width:\x20100%;\x22>Register\x20Student</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', '>Sec2</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22Sec3\x22\x20', 'numeric', 'performance-date', 'Stage', '</span><span\x20style=\x22color:#ef4444;\x20font-size:0.75rem;\x20margin-right:2px;\x22>EGP</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'pdf-template', '654534YEJdTB', 'Parent\x20Phone', '#ef4444', 'Created\x20At', '\x22\x20required\x20maxlength=\x2211\x22\x20minlength=\x2211\x22\x20pattern=\x22[0-9]{11}\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Photo\x20URL</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22url\x22\x20id=\x22edit-photo-url\x22\x20value=\x22', '50178FEdbPw', 'student-stage', 'none', 'querySelectorAll', 'createElement', 'theme', 'onerror', 'name', 'login-error', 'toString', 'toggle', 'امتحان\x20شهر', 'title', 'book_append_sheet', '<span\x20style=\x22color:\x20#64748b;\x20font-size:\x200.75rem;\x20margin-right:\x205px;\x22>(', 'innerWidth', '</span>\x20/\x20', 'Grade(', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-bottom:\x201.5rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin:\x200;\x22>Generate\x20Performance\x20Reports</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22exportReportStatusToExcel()\x22\x20class=\x22btn\x20btn-secondary\x22\x20style=\x22background-color:\x20#10b981;\x20color:\x20white;\x20border-color:\x20#10b981;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-file-excel\x22></i>\x20Export\x20Report\x20Status\x20(Excel)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20var(--text-muted);\x20margin-bottom:\x201.5rem;\x22>Student\x20performance\x20report\x20to\x20be\x20sent\x20to\x20guardian.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22grid-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Search\x20Student</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20id=\x22report-student-id\x22\x20placeholder=\x22Student\x20Code...\x22\x20maxlength=\x224\x22\x20pattern=\x22[0-9]{3,4}\x22\x20oninput=\x22updateStudentNamePreview(\x27report-student-id\x27,\x20\x27report-name-preview\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20id=\x22report-name-preview\x22\x20style=\x22margin-top:\x200.3rem;\x20font-size:\x200.85rem;\x20color:\x20var(--primary-color);\x20font-weight:\x20bold;\x20min-height:\x201.2rem;\x22></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Select\x20Month</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22report-month\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x27)\x22\x20class=\x22btn-action\x20btn-view\x22><i\x20class=\x22fas\x20fa-user\x22></i>\x20Profile</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22editStudentProfile(\x27', 'pdf-grades-body', ')</span>', 'startsWith', 'Sheets', 'Student\x20List', 'array', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x201rem;\x22>', 'textContent', 'Deleted', 'width', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'color', '<tr><td\x20colspan=\x224\x22\x20style=\x22text-align:\x20center;\x20padding:\x2010px;\x20border:\x201px\x20solid\x20#ddd;\x22>لا\x20يوجد\x20سجلات\x20لهذا\x20الشهر</td></tr>', 'size', 'Sec3', 'filter', 'age', 'guardian-phone', 'top-bar-extra', 'Sec1', 'stage', 'Phone', '#f59e0b', '---', 'edit', 'dashboard-month-filter', 'Register\x20Student', 'Import\x20Error', '<option\x20value=\x22', 'reduce', '>Sec1</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22Sec2\x22\x20', '</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x2010px;\x20border:\x201px\x20solid\x20#ddd;\x20text-align:\x20center;\x22>', 'Students_Data_', 'getMonth', 'login-form', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Edit\x20Profile</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22edit-student-form\x22\x20class=\x22grid-3\x22\x20style=\x22margin-top:\x201rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Student\x20Name</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20id=\x22edit-name\x22\x20value=\x22', 'error', 'photo', '_attendance', 'dateStr', 'student-phone', 'Student\x20Name:\x20', '<i\x20class=\x22fas\x20fa-sticky-note\x22\x20title=\x22', 'sheet_to_json', 'Copy\x20Failed', 'sort', 'pdf-student-name', 'Canvas\x20was\x20not\x20created', '.nav-link', '✅\x20Report\x20copied\x20as\x20image\x20successfully!\x0a\x0a', 'btn-secondary', '\x27)\x22\x20class=\x22btn-action\x20btn-delete\x22><i\x20class=\x22fas\x20fa-trash\x22></i>\x20Delete</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'writeFile', 'querySelector', 'localeCompare', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22\x20style=\x22margin-bottom:\x202rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x200.5rem;\x20flex-wrap:\x20wrap;\x20justify-content:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22updateDashboardStats(null)\x22\x20class=\x22btn\x20btn-primary\x20filter-btn\x20active\x22\x20data-stage=\x22all\x22>All</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22updateDashboardStats(\x27prep1\x27)\x22\x20class=\x22btn\x20btn-secondary\x20filter-btn\x22\x20data-stage=\x22prep1\x22>Prep1</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22updateDashboardStats(\x27prep2\x27)\x22\x20class=\x22btn\x20btn-secondary\x20filter-btn\x22\x20data-stage=\x22prep2\x22>Prep2</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22updateDashboardStats(\x27prep3\x27)\x22\x20class=\x22btn\x20btn-secondary\x20filter-btn\x22\x20data-stage=\x22prep3\x22>Prep3</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22updateDashboardStats(\x27Sec1\x27)\x22\x20class=\x22btn\x20btn-secondary\x20filter-btn\x22\x20data-stage=\x22Sec1\x22>Sec1</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22updateDashboardStats(\x27Sec2\x27)\x22\x20class=\x22btn\x20btn-secondary\x20filter-btn\x22\x20data-stage=\x22Sec2\x22>Sec2</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22updateDashboardStats(\x27Sec3\x27)\x22\x20class=\x22btn\x20btn-secondary\x20filter-btn\x22\x20data-stage=\x22Sec3\x22>Sec3</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22grid-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Total\x20Students</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20id=\x22stat-total-students\x22\x20style=\x22font-size:\x202rem;\x20font-weight:\x20bold;\x20color:\x20var(--primary-color);\x22>0</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Attendance\x20(Month)</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20id=\x22stat-today-attendance\x22\x20style=\x22font-size:\x202rem;\x20font-weight:\x20bold;\x20color:\x20#10b981;\x22>0</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Average\x20Score</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20id=\x22stat-avg-score\x22\x20style=\x22font-size:\x202rem;\x20font-weight:\x20bold;\x20color:\x20#f59e0b;\x22>0%</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Total\x20Expenses</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20id=\x22stat-total-expenses\x22\x20style=\x22font-size:\x202rem;\x20font-weight:\x20bold;\x20color:\x20#ef4444;\x22>0\x20EGP</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22\x20style=\x22margin-top:\x202rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>Weekly\x20Attendance\x20Analysis</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chart-container\x22\x20style=\x22position:\x20relative;\x20height:\x20350px;\x20width:\x20100%;\x20margin-top:\x201rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22attendanceChart\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'report-month', 'edit-student-form', 'fa-file-alt', 'date', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20', 'find', 'Student\x20not\x20found!', 'amount', 'target', 'prep1', 'No\x20students\x20found\x20in\x20this\x20stage.', 'toLocaleString', 'value', 'keys', 'edit-name', 'pdf-report-month', '.xlsx', 'addEventListener', 'student-list', 'pdf-report-note-container', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'student-name', '</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20Age\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x200.5rem;\x20padding:\x200.3rem\x200.5rem;\x20background:\x20var(--bg-color);\x20border-radius:\x20var(--radius);\x20border:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22width:\x2026px;\x20height:\x2026px;\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20background:\x20rgba(245,\x20158,\x2011,\x200.1);\x20color:\x20#f59e0b;\x20border-radius:\x206px;\x20font-size:\x200.8rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-birthday-cake\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x200.65rem;\x20color:\x20var(--text-muted);\x20margin:\x200;\x22>Age</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20700;\x20margin:\x200;\x20font-size:\x200.85rem;\x22>', 'href', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x202rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20Attendance\x20Section\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3><i\x20class=\x22fas\x20fa-clipboard-check\x22\x20style=\x22color:\x20var(--primary-color);\x20margin-left:\x200.5rem;\x22></i>\x20Mark\x20Attendance</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20var(--text-muted);\x20font-size:\x200.9rem;\x20margin-bottom:\x201rem;\x22>Record\x20performance\x20for\x20the\x20date\x20selected\x20above.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x201rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22display:\x20block;\x20margin-bottom:\x200.5rem;\x20font-weight:\x20600;\x22>Student\x20Code\x20or\x20Name</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22attendance-input-group\x22\x20style=\x22display:\x20flex;\x20gap:\x200.5rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20id=\x22attendance-id-input\x22\x20placeholder=\x22Search...\x22\x20style=\x22flex:\x201;\x22\x20maxlength=\x224\x22\x20pattern=\x22[0-9]*\x22\x20oninput=\x22updateStudentNamePreview(\x27attendance-id-input\x27,\x20\x27attendance-name-preview\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22markAttendance()\x22\x20class=\x22btn\x20btn-primary\x22\x20style=\x22padding:\x200.5rem\x201rem;\x22>Mark\x20Present</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20id=\x22attendance-name-preview\x22\x20style=\x22margin-top:\x200.3rem;\x20font-size:\x200.85rem;\x20color:\x20var(--primary-color);\x20font-weight:\x20bold;\x20min-height:\x201.2rem;\x22></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22attendance-feedback\x22\x20style=\x22margin-top:\x200.5rem;\x20font-weight:\x20bold;\x20min-height:\x201.5rem;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20Grades\x20Section\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3><i\x20class=\x22fas\x20fa-star\x22\x20style=\x22color:\x20#f59e0b;\x20margin-left:\x200.5rem;\x22></i>\x20Add\x20Grades</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22performance-form-grid\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Student\x20Code</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20id=\x22grade-student-id\x22\x20maxlength=\x224\x22\x20pattern=\x22[0-9]{3,4}\x22\x20oninput=\x22updateStudentNamePreview(\x27grade-student-id\x27,\x20\x27grade-name-preview\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20id=\x22grade-name-preview\x22\x20style=\x22margin-top:\x200.3rem;\x20font-size:\x200.85rem;\x20color:\x20var(--primary-color);\x20font-weight:\x20bold;\x20min-height:\x201.2rem;\x22></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Exam\x20Type</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22exam-type\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22quiz\x22>Quiz</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22monthly\x22>Monthly\x20Exam</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Score</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20id=\x22student-score\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Max\x20Score</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20id=\x22max-score\x22\x20value=\x2220\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22grid-column:\x20span\x204;\x20display:\x20flex;\x20align-items:\x20flex-end;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22saveGrade()\x22\x20class=\x22btn\x20btn-primary\x22\x20style=\x22width:\x20100%;\x22>Save\x20Grade</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20Fees\x20Section\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3><i\x20class=\x22fas\x20fa-money-bill-wave\x22\x20style=\x22color:\x20#10b981;\x20margin-left:\x200.5rem;\x22></i>\x20Register\x20Fees</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22grid-3\x22\x20style=\x22margin-top:\x201rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Student\x20Code</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20id=\x22fee-student-id\x22\x20maxlength=\x224\x22\x20pattern=\x22[0-9]{3,4}\x22\x20oninput=\x22updateStudentNamePreview(\x27fee-student-id\x27,\x20\x27fee-name-preview\x27)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20id=\x22fee-name-preview\x22\x20style=\x22margin-top:\x200.3rem;\x20font-size:\x200.85rem;\x20color:\x20var(--primary-color);\x20font-weight:\x20bold;\x20min-height:\x201.2rem;\x22></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Amount\x20(EGP)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20id=\x22fee-amount\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Expense\x20Note\x20/\x20Month</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22fee-note\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22\x22>Select\x20Note...</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x20students.\x0aDo\x20you\x20want\x20to\x20proceed?', '</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x201rem;\x22><span\x20class=\x22badge\x22\x20style=\x22background:\x20var(--border-color);\x20color:\x20var(--text-color);\x20padding:\x204px\x208px;\x20border-radius:\x206px;\x20font-size:\x200.9rem;\x22>', 'className', 'dark', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22اشتراك\x20ملازم\x22>Book\x20Subscription</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22حصه\x22\x20selected>Session</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22رسوم\x20اختبار\x22>Exam\x20Fees</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22أخرى\x22>Other</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22grid-column:\x20span\x203;\x20display:\x20flex;\x20align-items:\x20flex-end;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22saveFee()\x22\x20class=\x22btn\x20btn-primary\x22\x20style=\x22width:\x20100%;\x22>Register\x20Amount</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'onload', 'block', '</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20Note\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'ref', 'setAttribute', '\x20on\x20', 'getFullYear', '</span><span\x20style=\x22font-size:0.75rem;\x20opacity:0.8;\x20margin:0\x202px;\x22>/</span>', 'book_new', 'حصة', 'Report_Status_', 'Dashboard', 'modal-btn-primary', 'Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20', '79090vStzSU', 'preventDefault', 'students', 'section-title', 'grade-student-id', 'edit-photo-url', 'format', 'note', 'Failed\x20to\x20generate\x20image.', 'File\x20rejected\x20to\x20ensure\x20data\x20integrity.\x0aReason:\x20Column\x20order\x20or\x20names\x20do\x20not\x20match\x20system\x20format.\x0aPlease\x20use\x20a\x20file\x20exported\x20via\x20\x22Export\x20Excel\x22\x20without\x20modifying\x20column\x20order.', 'max-score', '\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Age</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20id=\x22edit-age\x22\x20value=\x22', 'dataset', 'trim', '0000', 'Quiz', 'phone', 'Attended\x20this\x20Month', '>All\x20Months</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'toBlob', 'Are\x20you\x20ready\x20to\x20proceed?', 'getItem', 'Delete\x20Student', 'Thu', 'edit-note', 'closed', '\x20لشهر\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20style=\x22border-bottom:\x201px\x20solid\x20var(--border-color);\x20vertical-align:\x20middle;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x201rem;\x20width:\x20140px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:700;\x20color:var(--text-color);\x22>', 'read', '</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20Guardian\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x200.5rem;\x20padding:\x200.3rem\x200.5rem;\x20background:\x20var(--bg-color);\x20border-radius:\x20var(--radius);\x20border:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22width:\x2026px;\x20height:\x2026px;\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20background:\x20rgba(239,\x2068,\x2068,\x200.1);\x20color:\x20#ef4444;\x20border-radius:\x206px;\x20font-size:\x200.8rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-user-shield\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x200.65rem;\x20color:\x20var(--text-muted);\x20margin:\x200;\x22>Guardian</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20700;\x20margin:\x200;\x20font-size:\x200.85rem;\x20direction:\x20ltr;\x22>', '<tr><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20center;\x20padding:\x203rem;\x20color:var(--text-muted);\x22><i\x20class=\x22fas\x20fa-history\x22\x20style=\x22font-size:2rem;\x20display:block;\x20margin-bottom:1rem;\x20opacity:0.3;\x22></i>No\x20records\x20found\x20for\x20this\x20period.</td></tr>', 'fee-student-id', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22dashboard-month-filter\x22\x20class=\x22form-control\x22\x20style=\x22width:\x20auto;\x20padding:\x200.3rem\x201rem;\x20border-radius:\x208px;\x20border:\x201px\x20solid\x20var(--primary-color);\x20font-weight:\x20bold;\x22\x20onchange=\x22updateDashboardStats(undefined,\x20this.value)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'edit-phone', '2405040EALmXj', 'show', 'report-filter-stage', '\x27)\x22\x20class=\x22btn-action\x20btn-edit\x22><i\x20class=\x22fas\x20fa-edit\x22></i>\x20Edit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22deleteStudent(\x27', 'login-password', 'pdf-payments-total', 'long', 'WhatsAppTab', 'selected', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22grid-column:\x20span\x202;\x20margin-top:\x20-1.8rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Additional\x20Note\x20(Appears\x20in\x20Report)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22report-note\x22\x20placeholder=\x22Write\x20a\x20note\x20for\x20the\x20teacher\x20here...\x22\x20style=\x22width:\x20100%;\x20padding:\x2010px;\x20border-radius:\x208px;\x20border:\x201px\x20solid\x20var(--border-color);\x20background:\x20var(--bg-color);\x20color:\x20var(--text-color);\x20font-family:\x20inherit;\x22\x20rows=\x223\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22grid-column:\x20span\x202;\x20margin-top:\x20-1.2rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22generateStudentPDF()\x22\x20class=\x22btn\x20btn-primary\x22\x20style=\x22width:\x20100%;\x22><i\x20class=\x22fas\x20fa-copy\x22></i>\x20Generate\x20Report\x20&\x20Send\x20(WhatsApp)</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '_payments', 'clipboard', '<div\x20class=\x22avatar\x22\x20style=\x22width:\x20120px;\x20height:\x20120px;\x20margin:\x200\x20auto;\x20font-size:\x203rem;\x20display:flex;\x20align-items:center;\x20justify-content:center;\x20background:var(--bg-color);\x20border-radius:50%;\x20border:3px\x20solid\x20var(--primary-color);\x22>', 'toISOString', 'https://web.whatsapp.com/send?phone=', 'primary', 'Reports\x20&\x20Messages', 'No\x20Name']; _0x4b05 = function () { return _0x2f002f; }; return _0x4b05(); } function renderDashboard() { const _0x17f405 = _0x32e985, _0x9c7ac = document[_0x17f405(0x20c)]('content-area'), _0x51f1fd = document['getElementById']('top-bar-extra'), _0x3cd43e = new Date()['getMonth']() + 0x1; _0x51f1fd[_0x17f405(0x1ba)] = _0x17f405(0x2e8) + Array[_0x17f405(0x199)]({ 'length': 0xc }, (_0x341878, _0x5cf5e1) => { const _0x202bd5 = _0x17f405, _0x161184 = _0x5cf5e1 + 0x1; return _0x202bd5(0x280) + _0x161184 + '\x22\x20' + (_0x161184 === _0x3cd43e ? _0x202bd5(0x2f2) : '') + '>' + new Intl[(_0x202bd5(0x19c))](_0x202bd5(0x1dc), { 'month': _0x202bd5(0x2f0) })[_0x202bd5(0x2ce)](new Date(0x7e8, _0x5cf5e1)) + _0x202bd5(0x1a6); })['join']('') + _0x17f405(0x2a0), _0x9c7ac['innerHTML'] = _0x17f405(0x29b), updateDashboardStats(null, _0x3cd43e); } function updateDashboardStats(_0x2a8365, _0x50dd9e = null) { const _0x4d4d59 = _0x32e985; if (_0x50dd9e === null) { const _0x388e8f = document['getElementById'](_0x4d4d59(0x27d)); _0x50dd9e = _0x388e8f ? parseInt(_0x388e8f[_0x4d4d59(0x2a8)]) : new Date()[_0x4d4d59(0x285)]() + 0x1; } if (_0x2a8365 === undefined) { const _0x526877 = document[_0x4d4d59(0x299)]('.filter-btn.btn-primary'); _0x2a8365 = _0x526877 && _0x526877['dataset']['stage'] !== 'all' ? _0x526877['dataset']['stage'] : null; } document[_0x4d4d59(0x253)](_0x4d4d59(0x212))['forEach'](_0x5e23f9 => { const _0x570144 = _0x4d4d59; _0x2a8365 === null && _0x5e23f9[_0x570144(0x2d4)]['stage'] === _0x570144(0x21c) || _0x5e23f9[_0x570144(0x2d4)]['stage'] === _0x2a8365 ? (_0x5e23f9[_0x570144(0x20e)][_0x570144(0x1a7)](_0x570144(0x1af)), _0x5e23f9[_0x570144(0x20e)][_0x570144(0x1dd)](_0x570144(0x296))) : (_0x5e23f9[_0x570144(0x20e)]['add'](_0x570144(0x296)), _0x5e23f9[_0x570144(0x20e)][_0x570144(0x1dd)](_0x570144(0x1af))); }); const _0x3a2c01 = _0x2a8365 ? students[_0x4d4d59(0x273)](_0x9d522e => _0x9d522e[_0x4d4d59(0x278)] === _0x2a8365) : students; document[_0x4d4d59(0x20c)]('stat-total-students')['textContent'] = _0x3a2c01[_0x4d4d59(0x1b5)]; const _0x56ca2d = _0x3a2c01[_0x4d4d59(0x281)]((_0x3d21d3, _0x36d167) => { const _0x179d14 = _0x4d4d59, _0x76d01 = (_0x36d167[_0x179d14(0x1f4)] || [])[_0x179d14(0x273)](_0x10c34d => new Date(_0x10c34d)[_0x179d14(0x285)]() + 0x1 === parseInt(_0x50dd9e))['length']; return _0x3d21d3 + (_0x76d01 > 0x0 ? 0x1 : 0x0); }, 0x0); document[_0x4d4d59(0x299)](_0x4d4d59(0x1b9))[_0x4d4d59(0x2fc)][_0x4d4d59(0x26b)] = _0x4d4d59(0x2d9), document['getElementById']('stat-today-attendance')['textContent'] = _0x56ca2d; let _0xc3ce7b = 0x0, _0x457e78 = 0x0; _0x3a2c01['forEach'](_0x3e880d => { const _0x54bbcb = _0x4d4d59; (_0x3e880d[_0x54bbcb(0x19b)] || [])[_0x54bbcb(0x273)](_0x4e2fed => new Date(_0x4e2fed[_0x54bbcb(0x29f)])['getMonth']() + 0x1 === parseInt(_0x50dd9e))[_0x54bbcb(0x19f)](_0x2f3d6c => { const _0x4e86b = _0x54bbcb; _0xc3ce7b += parseFloat(_0x2f3d6c['score']), _0x457e78 += parseFloat(_0x2f3d6c[_0x4e86b(0x238)]); }); }); const _0x412f5b = _0x457e78 > 0x0 ? Math[_0x4d4d59(0x1ea)](_0xc3ce7b / _0x457e78 * 0x64) : 0x0; document[_0x4d4d59(0x20c)](_0x4d4d59(0x240))[_0x4d4d59(0x26b)] = _0x412f5b + '%'; let _0x52400c = 0x0; _0x3a2c01[_0x4d4d59(0x19f)](_0x394c90 => { const _0x4a3375 = _0x4d4d59; _0x394c90[_0x4a3375(0x1ff)] && _0x394c90[_0x4a3375(0x1ff)][_0x4a3375(0x273)](_0x4ed4e3 => new Date(_0x4ed4e3[_0x4a3375(0x29f)])[_0x4a3375(0x285)]() + 0x1 === parseInt(_0x50dd9e))[_0x4a3375(0x19f)](_0x256704 => { _0x52400c += parseFloat(_0x256704['amount']) || 0x0; }); }), document[_0x4d4d59(0x20c)](_0x4d4d59(0x222))[_0x4d4d59(0x26b)] = _0x52400c['toLocaleString']() + '\x20EGP', initDashboardChart(_0x3a2c01); } function initDashboardChart(_0x244b26 = students) { const _0x51a81e = _0x32e985, _0x538f45 = document[_0x51a81e(0x20c)](_0x51a81e(0x1b7))?.[_0x51a81e(0x203)]('2d'); if (!_0x538f45) return; const _0x48f706 = Chart[_0x51a81e(0x300)](_0x51a81e(0x1b7)); if (_0x48f706) _0x48f706[_0x51a81e(0x198)](); const _0x3f8ecd = [_0x51a81e(0x20d), _0x51a81e(0x226), _0x51a81e(0x20a), _0x51a81e(0x1ad), _0x51a81e(0x2df)], _0x209833 = _0x244b26[_0x51a81e(0x1b5)], _0x48aa29 = [Math['round'](_0x209833 * 0.8), Math[_0x51a81e(0x1ea)](_0x209833 * 0.9), Math[_0x51a81e(0x1ea)](_0x209833 * 0.7), Math[_0x51a81e(0x1ea)](_0x209833 * 0.95), Math[_0x51a81e(0x1ea)](_0x209833 * 0.85)]; new Chart(_0x538f45, { 'type': 'line', 'data': { 'labels': _0x3f8ecd, 'datasets': [{ 'label': _0x51a81e(0x1cc), 'data': _0x48aa29, 'borderColor': _0x51a81e(0x1a5), 'backgroundColor': 'rgba(79,\x2070,\x20229,\x200.1)', 'fill': !![], 'tension': 0.4 }] }, 'options': { 'responsive': !![], 'maintainAspectRatio': ![], 'plugins': { 'legend': { 'display': ![] } }, 'scales': { 'y': { 'beginAtZero': !![] } } } }); } function initTheme() { const _0x222ae5 = _0x32e985, _0x32074a = document[_0x222ae5(0x20c)](_0x222ae5(0x237)), _0x36f777 = document[_0x222ae5(0x1ae)], _0x5a268e = localStorage[_0x222ae5(0x2dd)](_0x222ae5(0x255)) || 'dark'; _0x36f777[_0x222ae5(0x2be)](_0x222ae5(0x23b), _0x5a268e), _0x486d14(_0x5a268e), _0x32074a[_0x222ae5(0x2ad)](_0x222ae5(0x20f), () => { const _0x37d451 = _0x222ae5, _0x591f84 = _0x36f777['getAttribute'](_0x37d451(0x23b)), _0x586c2b = _0x591f84 === _0x37d451(0x2b8) ? _0x37d451(0x205) : _0x37d451(0x2b8); _0x36f777[_0x37d451(0x2be)](_0x37d451(0x23b), _0x586c2b), localStorage[_0x37d451(0x1cd)](_0x37d451(0x255), _0x586c2b), _0x486d14(_0x586c2b); }); function _0x486d14(_0x26d79a) { const _0x1cd88d = _0x222ae5; _0x26d79a === 'dark' ? _0x32074a[_0x1cd88d(0x1ba)] = _0x1cd88d(0x1e0) : _0x32074a['innerHTML'] = _0x1cd88d(0x1bb); } } function generateID() { const _0x4d3846 = _0x32e985; let _0x44a181; do { _0x44a181 = Math['floor'](0x3e8 + Math[_0x4d3846(0x243)]() * 0x2328)[_0x4d3846(0x259)](); } while (students[_0x4d3846(0x1a1)](_0x2d4c52 => _0x2d4c52['id'] === _0x44a181)); return _0x44a181; } function renderStudentsSection() { const _0x14dd56 = _0x32e985, _0x418fc6 = document[_0x14dd56(0x20c)](_0x14dd56(0x23a)); _0x418fc6[_0x14dd56(0x1ba)] = _0x14dd56(0x244), document['getElementById'](_0x14dd56(0x1d7))[_0x14dd56(0x2ad)](_0x14dd56(0x1a8), handleAddStudent); } function renderStudentListSection() { const _0x1d6070 = _0x32e985, _0x5234cf = document['getElementById'](_0x1d6070(0x23a)); _0x5234cf[_0x1d6070(0x1ba)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-bottom:\x201.5rem;\x20flex-wrap:\x20wrap;\x20gap:\x201rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin:\x200;\x22>Student\x20List</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x200.5rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22exportToExcel()\x22\x20class=\x22btn\x22\x20style=\x22background:\x20#10b981;\x20color:\x20white;\x20padding:\x200.5rem\x201rem;\x20font-size:\x200.9rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-file-export\x22></i>\x20Export\x20Excel\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22document.getElementById(\x27import-excel-input\x27).click()\x22\x20class=\x22btn\x22\x20style=\x22background:\x20#4f46e5;\x20color:\x20white;\x20padding:\x200.5rem\x201rem;\x20font-size:\x200.9rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-file-import\x22></i>\x20Import\x20Excel\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22import-excel-input\x22\x20style=\x22display:\x20none;\x22\x20accept=\x22.xlsx,\x20.xls\x22\x20onchange=\x22importFromExcel(this)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-filter-grid\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Search\x20by\x20Name,\x20Code,\x20or\x20Phone</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20id=\x22search-student\x22\x20oninput=\x22updateStudentFilter()\x22\x20placeholder=\x22Search...\x22\x20style=\x22font-size:\x201.2rem;\x20padding:\x201rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Filter\x20by\x20Stage</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22filter-stage\x22\x20onchange=\x22updateStudentFilter()\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22\x22>All\x20Stages</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22prep1\x22>Prep1</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22prep2\x22>Prep2</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22prep3\x22>Prep3</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22Sec1\x22>Sec1</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22Sec2\x22>Sec2</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22Sec3\x22>Sec3</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22student-list-container\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', displayStudentList(); } function updateStudentFilter() { const _0x52420a = _0x32e985, _0x355c93 = document[_0x52420a(0x20c)](_0x52420a(0x1e3))['value'], _0x3f0ff0 = document[_0x52420a(0x20c)](_0x52420a(0x225))[_0x52420a(0x2a8)]; displayStudentList(_0x355c93, _0x3f0ff0); } function _0x3ce1(_0x417496, _0x3604d0) { _0x417496 = _0x417496 - 0x192; const _0x4b059c = _0x4b05(); let _0x3ce1e2 = _0x4b059c[_0x417496]; return _0x3ce1e2; } async function handleAddStudent(_0x5a255a) { const _0x1fb134 = _0x32e985; _0x5a255a[_0x1fb134(0x2c9)](); const _0x1a6115 = document[_0x1fb134(0x20c)](_0x1fb134(0x206))[_0x1fb134(0x2a8)], _0x176e2a = document[_0x1fb134(0x20c)](_0x1fb134(0x2b1))[_0x1fb134(0x2a8)], _0x127405 = document['getElementById'](_0x1fb134(0x1c1))[_0x1fb134(0x2a8)], _0x5bb063 = document[_0x1fb134(0x20c)](_0x1fb134(0x251))[_0x1fb134(0x2a8)], _0x4d27ef = document[_0x1fb134(0x20c)](_0x1fb134(0x28c))[_0x1fb134(0x2a8)], _0x10c077 = document[_0x1fb134(0x20c)](_0x1fb134(0x275))[_0x1fb134(0x2a8)], _0x367fac = document[_0x1fb134(0x20c)](_0x1fb134(0x233))['value'], _0x2c35d4 = document[_0x1fb134(0x20c)](_0x1fb134(0x23c))[_0x1fb134(0x2a8)]; if (students[_0x1fb134(0x1a1)](_0x2c5603 => _0x2c5603['id'] === _0x1a6115)) { await Modal[_0x1fb134(0x215)](_0x1fb134(0x21d), _0x1fb134(0x1c5)); return; } const _0x3119a5 = { 'id': _0x1a6115, 'name': _0x176e2a, 'age': _0x127405, 'stage': _0x5bb063, 'phone': _0x4d27ef, 'guardianPhone': _0x10c077, 'photo': _0x367fac, 'note': _0x2c35d4, 'attendance': [], 'grades': [], 'payments': [], 'createdAt': new Date()[_0x1fb134(0x2f7)]() }; students[_0x1fb134(0x1e2)](_0x3119a5), saveToFirebase(), await Modal[_0x1fb134(0x215)](_0x1fb134(0x1a2), 'Student\x20Registered\x20Successfully!\x0aID:\x20' + _0x3119a5['id']), renderStudentsSection(); } function displayStudentList(_0x5e23f4 = '', _0x202e07 = '') { const _0x54ad70 = _0x32e985, _0x557b9e = document[_0x54ad70(0x20c)](_0x54ad70(0x239)); if (!students[_0x54ad70(0x1b5)]) { _0x557b9e[_0x54ad70(0x1ba)] = _0x54ad70(0x201); return; } const _0x36ae37 = students[_0x54ad70(0x273)](_0x32712d => { const _0x9417a2 = _0x54ad70, _0x529cbe = _0x32712d[_0x9417a2(0x257)][_0x9417a2(0x216)](_0x5e23f4) || _0x32712d['id'][_0x9417a2(0x216)](_0x5e23f4) || _0x32712d[_0x9417a2(0x2d8)] && _0x32712d[_0x9417a2(0x2d8)][_0x9417a2(0x216)](_0x5e23f4), _0x474f39 = _0x202e07 === '' || _0x32712d[_0x9417a2(0x278)] === _0x202e07; return _0x529cbe && _0x474f39; })[_0x54ad70(0x291)]((_0x34a0c5, _0x19bc18) => parseInt(_0x34a0c5['id']) - parseInt(_0x19bc18['id'])); _0x557b9e[_0x54ad70(0x1ba)] = _0x54ad70(0x218) + _0x36ae37[_0x54ad70(0x230)](_0x2f4fd1 => _0x54ad70(0x1ee) + _0x2f4fd1['id'] + '</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x201rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x2f4fd1[_0x54ad70(0x257)] + _0x54ad70(0x1fd) + (_0x2f4fd1[_0x54ad70(0x2cf)] ? _0x54ad70(0x28e) + _0x2f4fd1[_0x54ad70(0x2cf)] + _0x54ad70(0x221) : '') + _0x54ad70(0x26a) + _0x2f4fd1[_0x54ad70(0x2d8)] + _0x54ad70(0x2b6) + (_0x2f4fd1[_0x54ad70(0x278)] || _0x54ad70(0x27b)) + _0x54ad70(0x1ca) + _0x2f4fd1['id'] + _0x54ad70(0x263) + _0x2f4fd1['id'] + _0x54ad70(0x2ed) + _0x2f4fd1['id'] + _0x54ad70(0x297))[_0x54ad70(0x1aa)]('') + _0x54ad70(0x1c0); } function renderPerformanceSection() { const _0x623bff = _0x32e985, _0x23b4d6 = document[_0x623bff(0x20c)](_0x623bff(0x23a)); _0x23b4d6[_0x623bff(0x1ba)] = _0x623bff(0x1ab) + new Date()[_0x623bff(0x2f7)]()[_0x623bff(0x195)]('T')[0x0] + _0x623bff(0x2b4) + [0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xa, 0xb, 0xc]['map'](_0x5831a1 => '<option\x20value=\x22Fees\x20for\x20' + new Intl[(_0x623bff(0x19c))](_0x623bff(0x1dc), { 'month': _0x623bff(0x2f0) })[_0x623bff(0x2ce)](new Date(0x7e8, _0x5831a1 - 0x1)) + '\x22>Month\x20Fees:\x20' + new Intl[(_0x623bff(0x19c))](_0x623bff(0x1dc), { 'month': _0x623bff(0x2f0) })[_0x623bff(0x2ce)](new Date(0x7e8, _0x5831a1 - 0x1)) + _0x623bff(0x1a6))['join']('') + _0x623bff(0x2b9); } function markAttendance() { const _0x493b2b = _0x32e985, _0x102ad6 = document[_0x493b2b(0x20c)]('attendance-id-input'), _0x3267aa = _0x102ad6[_0x493b2b(0x2a8)][_0x493b2b(0x2d5)](), _0x2a5254 = document['getElementById'](_0x493b2b(0x1a4)); if (!_0x3267aa) return; const _0x1bc07c = students[_0x493b2b(0x2a1)](_0x1ab7e3 => _0x1ab7e3['id'] === _0x3267aa || _0x1ab7e3['name'][_0x493b2b(0x2d5)]() === _0x3267aa); if (!_0x1bc07c) { _0x2a5254[_0x493b2b(0x26b)] = 'Error:\x20Student\x20not\x20found\x20(Check\x20Code\x20or\x20Full\x20Name)!', _0x2a5254[_0x493b2b(0x1f1)][_0x493b2b(0x26f)] = _0x493b2b(0x24d); return; } const _0x140d13 = document[_0x493b2b(0x20c)](_0x493b2b(0x247))[_0x493b2b(0x2a8)]; if (!_0x1bc07c[_0x493b2b(0x1f4)]) _0x1bc07c[_0x493b2b(0x1f4)] = []; _0x1bc07c[_0x493b2b(0x1f4)]['includes'](_0x140d13) ? (_0x2a5254['textContent'] = 'Student\x20' + _0x1bc07c['name'] + '\x20already\x20marked\x20present\x20for\x20' + _0x140d13 + '.', _0x2a5254[_0x493b2b(0x1f1)]['color'] = _0x493b2b(0x27a)) : (_0x1bc07c[_0x493b2b(0x1f4)]['push'](_0x140d13), saveToFirebase(), _0x2a5254[_0x493b2b(0x26b)] = 'Attendance\x20marked\x20for:\x20' + _0x1bc07c['name'] + _0x493b2b(0x2bf) + _0x140d13 + '\x20✅', _0x2a5254['style'][_0x493b2b(0x26f)] = '#10b981', _0x102ad6['value'] = ''); } function saveGrade() { const _0x3b674c = _0x32e985, _0x12c30c = document[_0x3b674c(0x20c)](_0x3b674c(0x2cc))[_0x3b674c(0x2a8)], _0x3aadc0 = document['getElementById'](_0x3b674c(0x1ef))['value'], _0x1969c7 = document[_0x3b674c(0x20c)](_0x3b674c(0x23d))['value'], _0x443f38 = document[_0x3b674c(0x20c)](_0x3b674c(0x2d2))[_0x3b674c(0x2a8)], _0x31e553 = students[_0x3b674c(0x2a1)](_0x4c5f2e => _0x4c5f2e['id'] === _0x12c30c); if (!_0x31e553) { Modal[_0x3b674c(0x215)](_0x3b674c(0x21d), 'Student\x20not\x20found!'); return; } const _0xe8468d = document[_0x3b674c(0x20c)]('performance-date')[_0x3b674c(0x2a8)], _0x41bd7a = _0xe8468d + 'T' + new Date()[_0x3b674c(0x2f7)]()[_0x3b674c(0x195)]('T')[0x1]; if (!_0x31e553['grades']) _0x31e553[_0x3b674c(0x19b)] = []; if (!_0x31e553['attendance']) _0x31e553[_0x3b674c(0x1f4)] = []; _0x31e553[_0x3b674c(0x19b)][_0x3b674c(0x1e2)]({ 'type': _0x3aadc0, 'score': _0x1969c7, 'max': _0x443f38, 'date': _0x41bd7a }), !_0x31e553['attendance'][_0x3b674c(0x216)](_0xe8468d) && _0x31e553[_0x3b674c(0x1f4)][_0x3b674c(0x1e2)](_0xe8468d), saveToFirebase(), Modal[_0x3b674c(0x215)](_0x3b674c(0x20b), _0x3b674c(0x261) + _0x3aadc0 + ')\x20saved\x20for\x20student\x20' + _0x31e553['name']), document[_0x3b674c(0x20c)](_0x3b674c(0x2cc))['value'] = '', document[_0x3b674c(0x20c)](_0x3b674c(0x23d))['value'] = '', document[_0x3b674c(0x20c)](_0x3b674c(0x1de))[_0x3b674c(0x26b)] = ''; } function updateStudentNamePreview(_0x1d0a36, _0x37cc5d) { const _0x1b8182 = _0x32e985, _0x3f745a = document[_0x1b8182(0x20c)](_0x1d0a36)[_0x1b8182(0x2a8)][_0x1b8182(0x2d5)](), _0x3a3951 = document['getElementById'](_0x37cc5d); if (_0x3f745a[_0x1b8182(0x1b5)] === 0x3 || _0x3f745a[_0x1b8182(0x1b5)] === 0x4) { const _0x33b243 = students[_0x1b8182(0x2a1)](_0x4fbc01 => _0x4fbc01['id'] === _0x3f745a); _0x33b243 ? (_0x3a3951[_0x1b8182(0x26b)] = _0x1b8182(0x28d) + _0x33b243[_0x1b8182(0x257)] + '\x20', _0x3a3951['style'][_0x1b8182(0x26f)] = 'var(--primary-color)') : (_0x3a3951[_0x1b8182(0x26b)] = 'Student\x20not\x20found!', _0x3a3951['style'][_0x1b8182(0x26f)] = '#ef4444'); } else _0x3a3951['textContent'] = ''; } function renderReportsSection() { const _0x5a9b4a = _0x32e985, _0xe22aa0 = document['getElementById']('content-area'); _0xe22aa0[_0x5a9b4a(0x1ba)] = _0x5a9b4a(0x262) + [0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xa, 0xb, 0xc][_0x5a9b4a(0x230)](_0x300ac6 => _0x5a9b4a(0x280) + _0x300ac6 + '\x22\x20' + (new Date()['getMonth']() + 0x1 === _0x300ac6 ? _0x5a9b4a(0x2f2) : '') + '>' + new Intl[(_0x5a9b4a(0x19c))](_0x5a9b4a(0x1dc), { 'month': _0x5a9b4a(0x2f0) })[_0x5a9b4a(0x2ce)](new Date(0x7e8, _0x300ac6 - 0x1)) + _0x5a9b4a(0x1a6))[_0x5a9b4a(0x1aa)]('') + _0x5a9b4a(0x2f3); } function saveFee() { const _0x27e59a = _0x32e985, _0x5dffa0 = document[_0x27e59a(0x20c)](_0x27e59a(0x2e7))[_0x27e59a(0x2a8)], _0x1eb366 = document[_0x27e59a(0x20c)](_0x27e59a(0x224))[_0x27e59a(0x2a8)], _0x1854b5 = document[_0x27e59a(0x20c)](_0x27e59a(0x1da))[_0x27e59a(0x2a8)], _0x3f7f75 = students[_0x27e59a(0x2a1)](_0x3f9253 => _0x3f9253['id'] === _0x5dffa0); if (!_0x3f7f75) { Modal[_0x27e59a(0x215)]('Error', _0x27e59a(0x2a2)); return; } if (!_0x3f7f75['payments']) _0x3f7f75[_0x27e59a(0x1ff)] = []; const _0x49365e = document[_0x27e59a(0x20c)](_0x27e59a(0x247))[_0x27e59a(0x2a8)], _0x30b17b = _0x49365e + 'T' + new Date()[_0x27e59a(0x2f7)]()[_0x27e59a(0x195)]('T')[0x1]; _0x3f7f75[_0x27e59a(0x1ff)][_0x27e59a(0x1e2)]({ 'amount': _0x1eb366, 'note': _0x1854b5, 'date': _0x30b17b }), saveToFirebase(), Modal[_0x27e59a(0x215)]('Registered', 'Amount\x20' + _0x1eb366 + _0x27e59a(0x1d1) + _0x3f7f75[_0x27e59a(0x257)]), document[_0x27e59a(0x20c)]('fee-amount')[_0x27e59a(0x2a8)] = '', document['getElementById'](_0x27e59a(0x1da))[_0x27e59a(0x2a8)] = ''; } async function deleteStudent(_0x3c489a) { const _0x9b97fc = _0x32e985, _0x3002e9 = students['find'](_0x402573 => _0x402573['id'] === _0x3c489a); if (!_0x3002e9) return; const _0x3dee55 = await Modal[_0x9b97fc(0x1d3)](_0x9b97fc(0x2de), _0x9b97fc(0x2c7) + _0x3002e9['name'] + _0x9b97fc(0x1e5)); _0x3dee55 && (students = students[_0x9b97fc(0x273)](_0x95dca2 => _0x95dca2['id'] !== _0x3c489a), saveToFirebase(), displayStudentList(), await Modal[_0x9b97fc(0x215)](_0x9b97fc(0x26c), 'Student\x20deleted\x20successfully.')); } function viewStudentProfile(_0x123579, _0x1673ff = null) { const _0x183e1d = _0x32e985, _0x11c67d = students[_0x183e1d(0x2a1)](_0x47029b => _0x47029b['id'] === _0x123579); if (!_0x11c67d) return; currentSection = _0x183e1d(0x208); const _0x3b8bd5 = document[_0x183e1d(0x20c)](_0x183e1d(0x23a)), _0xd00552 = [0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xa, 0xb, 0xc], _0x180210 = new Date()[_0x183e1d(0x285)]() + 0x1, _0x276c90 = _0x1673ff !== null && _0x1673ff !== _0x183e1d(0x21c) ? parseInt(_0x1673ff) : null; document[_0x183e1d(0x20c)](_0x183e1d(0x2cb))[_0x183e1d(0x26b)] = ''; const _0x54ae33 = {}, _0x44949e = _0x580d3f => { const _0x477f3c = _0x183e1d, _0x1e56a8 = new Date(_0x580d3f); return _0x1e56a8[_0x477f3c(0x2c0)]() + '-' + String(_0x1e56a8[_0x477f3c(0x285)]() + 0x1)[_0x477f3c(0x1be)](0x2, '0') + '-' + String(_0x1e56a8[_0x477f3c(0x234)]())[_0x477f3c(0x1be)](0x2, '0'); }; _0x11c67d[_0x183e1d(0x1f4)] = _0x11c67d['attendance'] || [], _0x11c67d[_0x183e1d(0x19b)] = _0x11c67d[_0x183e1d(0x19b)] || [], _0x11c67d[_0x183e1d(0x1ff)] = _0x11c67d['payments'] || [], _0x11c67d[_0x183e1d(0x1f4)][_0x183e1d(0x19f)](_0x39dad2 => { const _0x3a6d32 = _0x183e1d, _0x300209 = new Date(_0x39dad2); if (_0x276c90 === null || _0x300209[_0x3a6d32(0x285)]() + 0x1 === _0x276c90) { const _0x264549 = _0x44949e(_0x39dad2); if (!_0x54ae33[_0x264549]) _0x54ae33[_0x264549] = { 'date': _0x300209, 'attendance': !![], 'grades': [], 'payments': [] }; else _0x54ae33[_0x264549][_0x3a6d32(0x1f4)] = !![]; } }), _0x11c67d[_0x183e1d(0x19b)][_0x183e1d(0x19f)](_0x1ac702 => { const _0x5c5945 = _0x183e1d, _0x26dc61 = new Date(_0x1ac702[_0x5c5945(0x29f)]); if (_0x276c90 === null || _0x26dc61['getMonth']() + 0x1 === _0x276c90) { const _0x14a595 = _0x44949e(_0x1ac702['date']); if (!_0x54ae33[_0x14a595]) _0x54ae33[_0x14a595] = { 'date': _0x26dc61, 'attendance': ![], 'grades': [], 'payments': [] }; _0x54ae33[_0x14a595][_0x5c5945(0x19b)][_0x5c5945(0x1e2)](_0x1ac702); } }), (_0x11c67d[_0x183e1d(0x1ff)] || [])[_0x183e1d(0x19f)](_0x37a516 => { const _0x3421a7 = _0x183e1d, _0xa40e5a = new Date(_0x37a516['date']); if (_0x276c90 === null || _0xa40e5a[_0x3421a7(0x285)]() + 0x1 === _0x276c90) { const _0xbca8ae = _0x44949e(_0x37a516[_0x3421a7(0x29f)]); if (!_0x54ae33[_0xbca8ae]) _0x54ae33[_0xbca8ae] = { 'date': _0xa40e5a, 'attendance': ![], 'grades': [], 'payments': [] }; _0x54ae33[_0xbca8ae][_0x3421a7(0x1ff)][_0x3421a7(0x1e2)](_0x37a516); } }); const _0x293778 = Object['keys'](_0x54ae33)['sort']((_0x55a0b0, _0x1c87f6) => _0x1c87f6[_0x183e1d(0x29a)](_0x55a0b0))[_0x183e1d(0x230)](_0x51a96b => ({ 'dateStr': _0x51a96b, ..._0x54ae33[_0x51a96b] })); _0x3b8bd5[_0x183e1d(0x1ba)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22grid-3\x22\x20style=\x22align-items:\x20start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x22\x20style=\x22text-align:\x20center;\x20position:\x20sticky;\x20top:\x201rem;\x20padding:\x201rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20Floating\x20Action\x20Buttons\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20absolute;\x20top:\x2010px;\x20right:\x2010px;\x20display:\x20flex;\x20gap:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22editStudentProfile(\x27' + _0x11c67d['id'] + '\x27)\x22\x20title=\x22Edit\x20Profile\x22\x20style=\x22background:\x20none;\x20border:\x20none;\x20color:\x20var(--text-muted);\x20cursor:\x20pointer;\x20font-size:\x201.1rem;\x20transition:\x20color\x200.2s;\x22\x20onmouseover=\x22this.style.color=\x27var(--primary-color)\x27\x22\x20onmouseout=\x22this.style.color=\x27var(--text-muted)\x27\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-edit\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20absolute;\x20top:\x2010px;\x20left:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22navigateTo(\x27student-list\x27)\x22\x20title=\x22Back\x20to\x20List\x22\x20style=\x22background:\x20none;\x20border:\x20none;\x20color:\x20var(--text-muted);\x20cursor:\x20pointer;\x20font-size:\x201.1rem;\x20transition:\x20color\x200.2s;\x22\x20onmouseover=\x22this.style.color=\x27var(--primary-color)\x27\x22\x20onmouseout=\x22this.style.color=\x27var(--text-muted)\x27\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-arrow-left\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22profile-photo-container\x22\x20style=\x22margin-bottom:\x200.8rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x11c67d[_0x183e1d(0x289)] ? '<img\x20src=\x22' + _0x11c67d[_0x183e1d(0x289)] + '\x22\x20style=\x22width:\x20140px;\x20height:\x20140px;\x20border-radius:\x2050%;\x20object-fit:\x20cover;\x20border:\x203px\x20solid\x20var(--primary-color);\x20box-shadow:\x200\x204px\x206px\x20-1px\x20rgba(0,\x200,\x200,\x200.1);\x22>' : _0x183e1d(0x2f6) + _0x11c67d[_0x183e1d(0x257)][0x0] + '</div>') + _0x183e1d(0x210) + _0x11c67d['name'] + '</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20var(--text-muted);\x20margin-bottom:\x201rem;\x20font-size:\x200.9rem;\x22>Code:\x20' + _0x11c67d['id'] + _0x183e1d(0x202) + (_0x11c67d['stage'] || '-') + _0x183e1d(0x2b2) + _0x11c67d[_0x183e1d(0x274)] + '\x20years</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20Phone\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x200.5rem;\x20padding:\x200.3rem\x200.5rem;\x20background:\x20var(--bg-color);\x20border-radius:\x20var(--radius);\x20border:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22width:\x2026px;\x20height:\x2026px;\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20background:\x20rgba(16,\x20185,\x20129,\x200.1);\x20color:\x20#10b981;\x20border-radius:\x206px;\x20font-size:\x200.8rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-phone\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x200.65rem;\x20color:\x20var(--text-muted);\x20margin:\x200;\x22>Phone</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20700;\x20margin:\x200;\x20font-size:\x200.85rem;\x20direction:\x20ltr;\x22>' + _0x11c67d[_0x183e1d(0x2d8)] + _0x183e1d(0x2e5) + _0x11c67d[_0x183e1d(0x1f6)] + _0x183e1d(0x2bc) + (_0x11c67d[_0x183e1d(0x2cf)] ? _0x183e1d(0x21b) + _0x11c67d['note'] + '</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' : '') + _0x183e1d(0x1cb) + _0x123579 + _0x183e1d(0x2fe) + (_0x276c90 === null ? _0x183e1d(0x2f2) : '') + _0x183e1d(0x2da) + _0xd00552[_0x183e1d(0x230)](_0x2b6a5c => '<option\x20value=\x22' + _0x2b6a5c + '\x22\x20' + (_0x276c90 === _0x2b6a5c ? _0x183e1d(0x2f2) : '') + '>' + new Intl[(_0x183e1d(0x19c))]('en-GB', { 'month': _0x183e1d(0x2f0) })[_0x183e1d(0x2ce)](new Date(0x7e8, _0x2b6a5c - 0x1)) + '</option>')[_0x183e1d(0x1aa)]('') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x201rem;\x20max-height:\x20500px;\x20overflow-y:\x20auto;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22table-responsive\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table\x20style=\x22width:\x20100%;\x20border-collapse:\x20collapse;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20style=\x22text-align:\x20left;\x20border-bottom:\x202px\x20solid\x20var(--border-color);\x20background:\x20var(--bg-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x201rem;\x20border-top-right-radius:\x2012px;\x22>Date</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20style=\x22padding:\x201rem;\x20border-top-left-radius:\x2012px;\x22>Activity\x20&\x20Data</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x293778[_0x183e1d(0x230)](_0x5e6182 => { const _0x3c9473 = _0x183e1d, _0x21236d = []; return _0x5e6182[_0x3c9473(0x1f4)] && _0x21236d['push']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:flex;\x20align-items:center;\x20gap:5px;\x20background:rgba(16,\x20185,\x20129,\x200.1);\x20color:#10b981;\x20padding:4px\x2010px;\x20border-radius:8px;\x20font-weight:600;\x20font-size:0.85rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-check-circle\x22></i>\x20Attendance\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'), _0x5e6182[_0x3c9473(0x19b)][_0x3c9473(0x19f)](_0x13b4d0 => { const _0x2e7175 = _0x3c9473, _0x2b659f = _0x13b4d0['type'] === _0x2e7175(0x241); _0x21236d['push']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:flex;\x20align-items:center;\x20gap:5px;\x20background:rgba(79,\x2070,\x20229,\x200.1);\x20color:#4f46e5;\x20padding:4px\x2010px;\x20border-radius:8px;\x20font-weight:600;\x20font-size:0.85rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20' + (_0x2b659f ? _0x2e7175(0x228) : _0x2e7175(0x29e)) + _0x2e7175(0x1c9) + (_0x2b659f ? 'Quiz' : _0x2e7175(0x197)) + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:#10b981;\x20margin-right:5px;\x22>' + _0x13b4d0[_0x2e7175(0x1bc)] + _0x2e7175(0x2c1) + _0x13b4d0[_0x2e7175(0x238)] + _0x2e7175(0x26e)); }), _0x5e6182[_0x3c9473(0x1ff)][_0x3c9473(0x19f)](_0x591ae3 => { const _0x3a381f = _0x3c9473; _0x21236d[_0x3a381f(0x1e2)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:flex;\x20align-items:center;\x20gap:5px;\x20background:rgba(239,\x2068,\x2068,\x200.1);\x20color:#ef4444;\x20padding:4px\x2010px;\x20border-radius:8px;\x20font-weight:600;\x20font-size:0.85rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-money-bill-wave\x22></i>\x20Payment\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:#10b981;\x20margin-right:2px;\x22>' + _0x591ae3[_0x3a381f(0x2a3)] + _0x3a381f(0x249) + (_0x591ae3[_0x3a381f(0x2cf)] ? _0x3a381f(0x214) + _0x591ae3[_0x3a381f(0x2cf)] + '</span>' : '') + _0x3a381f(0x26e)); }), _0x3c9473(0x2e3) + new Date(_0x5e6182[_0x3c9473(0x28b)])[_0x3c9473(0x19e)](_0x3c9473(0x1dc), { 'day': _0x3c9473(0x246), 'month': 'short', 'year': _0x3c9473(0x246) }) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:0.75rem;\x20color:var(--text-muted);\x22>' + new Date(_0x5e6182['dateStr'])[_0x3c9473(0x19e)](_0x3c9473(0x1dc), { 'weekday': _0x3c9473(0x2f0) }) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20style=\x22padding:\x201rem;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-wrap:\x20wrap;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x21236d['join']('') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'; })[_0x183e1d(0x1aa)]('') || _0x183e1d(0x2e6)) + _0x183e1d(0x2b0); } function editStudentProfile(_0x417c16) { const _0x54c0ff = _0x32e985, _0x4c4949 = students['find'](_0x4f3939 => _0x4f3939['id'] === _0x417c16); if (!_0x4c4949) return; currentSection = _0x54c0ff(0x27c); const _0x56db84 = document['getElementById'](_0x54c0ff(0x23a)); document[_0x54c0ff(0x20c)](_0x54c0ff(0x2cb))['textContent'] = 'Edit\x20Student:\x20' + _0x4c4949['name'] + '\x20', _0x56db84['innerHTML'] = _0x54c0ff(0x287) + _0x4c4949[_0x54c0ff(0x257)] + _0x54c0ff(0x2d3) + _0x4c4949[_0x54c0ff(0x274)] + '\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Stage</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22edit-stage\x22\x20required>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22prep1\x22\x20' + (_0x4c4949['stage'] === _0x54c0ff(0x2a5) ? _0x54c0ff(0x2f2) : '') + _0x54c0ff(0x1b0) + (_0x4c4949[_0x54c0ff(0x278)] === 'prep2' ? _0x54c0ff(0x2f2) : '') + _0x54c0ff(0x1c7) + (_0x4c4949[_0x54c0ff(0x278)] === _0x54c0ff(0x1b8) ? _0x54c0ff(0x2f2) : '') + '>Prep3</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22Sec1\x22\x20' + (_0x4c4949[_0x54c0ff(0x278)] === _0x54c0ff(0x277) ? 'selected' : '') + _0x54c0ff(0x282) + (_0x4c4949[_0x54c0ff(0x278)] === 'Sec2' ? 'selected' : '') + _0x54c0ff(0x245) + (_0x4c4949[_0x54c0ff(0x278)] === _0x54c0ff(0x272) ? 'selected' : '') + _0x54c0ff(0x1c6) + _0x4c4949[_0x54c0ff(0x2d8)] + '\x22\x20required\x20maxlength=\x2211\x22\x20minlength=\x2211\x22\x20pattern=\x22[0-9]{11}\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Parent\x20Phone</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22tel\x22\x20id=\x22edit-guardian\x22\x20value=\x22' + _0x4c4949[_0x54c0ff(0x1f6)] + _0x54c0ff(0x24f) + (_0x4c4949[_0x54c0ff(0x289)] || '') + _0x54c0ff(0x229) + (_0x4c4949[_0x54c0ff(0x2cf)] || '') + _0x54c0ff(0x1fb) + _0x4c4949['id'] + _0x54c0ff(0x2fd), document[_0x54c0ff(0x20c)](_0x54c0ff(0x29d))[_0x54c0ff(0x2ad)](_0x54c0ff(0x1a8), async _0x3beb18 => { const _0x130ff7 = _0x54c0ff; _0x3beb18[_0x130ff7(0x2c9)](), _0x4c4949[_0x130ff7(0x257)] = document[_0x130ff7(0x20c)](_0x130ff7(0x2aa))[_0x130ff7(0x2a8)], _0x4c4949['age'] = document['getElementById']('edit-age')[_0x130ff7(0x2a8)], _0x4c4949[_0x130ff7(0x278)] = document[_0x130ff7(0x20c)]('edit-stage')[_0x130ff7(0x2a8)], _0x4c4949[_0x130ff7(0x2d8)] = document['getElementById'](_0x130ff7(0x2e9))[_0x130ff7(0x2a8)], _0x4c4949[_0x130ff7(0x1f6)] = document[_0x130ff7(0x20c)]('edit-guardian')[_0x130ff7(0x2a8)], _0x4c4949[_0x130ff7(0x289)] = document[_0x130ff7(0x20c)](_0x130ff7(0x2cd))[_0x130ff7(0x2a8)], _0x4c4949[_0x130ff7(0x2cf)] = document[_0x130ff7(0x20c)](_0x130ff7(0x2e0))['value'], saveToFirebase(), await Modal['alert']('Updated', _0x130ff7(0x1d6)), viewStudentProfile(_0x4c4949['id']); }); } async function generateStudentPDF() { const _0x433ce6 = _0x32e985, _0x387b35 = document['getElementById']('report-student-id')[_0x433ce6(0x2a8)], _0x357181 = parseInt(document['getElementById'](_0x433ce6(0x29c))[_0x433ce6(0x2a8)]), _0x2b9109 = document['getElementById'](_0x433ce6(0x235)) ? document[_0x433ce6(0x20c)](_0x433ce6(0x235))[_0x433ce6(0x2a8)][_0x433ce6(0x2d5)]() : '', _0x253029 = students[_0x433ce6(0x2a1)](_0x73f6a9 => _0x73f6a9['id'] === _0x387b35); if (!_0x253029) { Modal[_0x433ce6(0x215)](_0x433ce6(0x21d), _0x433ce6(0x1ec)); return; } document['getElementById'](_0x433ce6(0x292))[_0x433ce6(0x26b)] = _0x253029[_0x433ce6(0x257)]; const _0x34ac51 = document[_0x433ce6(0x20c)](_0x433ce6(0x22c)); let _0x14a91d = Promise['resolve'](); _0x253029[_0x433ce6(0x289)] ? (_0x14a91d = new Promise(_0x56e62d => { const _0x3902c3 = _0x433ce6; _0x34ac51[_0x3902c3(0x2ba)] = _0x56e62d, _0x34ac51[_0x3902c3(0x256)] = _0x56e62d, _0x34ac51[_0x3902c3(0x242)] = '', _0x34ac51['src'] = _0x253029[_0x3902c3(0x289)]; }), _0x34ac51[_0x433ce6(0x1f1)]['display'] = _0x433ce6(0x2bb)) : _0x34ac51[_0x433ce6(0x1f1)][_0x433ce6(0x193)] = _0x433ce6(0x252); document[_0x433ce6(0x20c)]('pdf-student-id')[_0x433ce6(0x26b)] = _0x253029['id'], document[_0x433ce6(0x20c)]('pdf-student-stage')[_0x433ce6(0x26b)] = _0x253029['stage'] || _0x433ce6(0x27b), document[_0x433ce6(0x20c)]('pdf-student-phone')[_0x433ce6(0x26b)] = _0x253029[_0x433ce6(0x2d8)], document['getElementById']('pdf-report-date')[_0x433ce6(0x26b)] = new Date()[_0x433ce6(0x19e)](_0x433ce6(0x1dc)), document[_0x433ce6(0x20c)](_0x433ce6(0x2ab))[_0x433ce6(0x26b)] = new Intl[(_0x433ce6(0x19c))]('ar-EG', { 'month': _0x433ce6(0x2f0) })[_0x433ce6(0x2ce)](new Date(0x7e8, _0x357181 - 0x1)); const _0x172580 = document[_0x433ce6(0x20c)](_0x433ce6(0x2af)), _0xc2bfa4 = document[_0x433ce6(0x20c)](_0x433ce6(0x21a)); _0x172580 && _0xc2bfa4 && (_0x2b9109 ? (_0xc2bfa4['textContent'] = _0x2b9109, _0x172580[_0x433ce6(0x1f1)]['display'] = _0x433ce6(0x2bb)) : _0x172580[_0x433ce6(0x1f1)][_0x433ce6(0x193)] = 'none'); const _0x2932c3 = {}, _0x1f8761 = _0x4dfa9f => { const _0x5b4b21 = _0x433ce6, _0x1f7283 = new Date(_0x4dfa9f); return _0x1f7283['getFullYear']() + '-' + String(_0x1f7283[_0x5b4b21(0x285)]() + 0x1)[_0x5b4b21(0x1be)](0x2, '0') + '-' + String(_0x1f7283[_0x5b4b21(0x234)]())[_0x5b4b21(0x1be)](0x2, '0'); }; (_0x253029[_0x433ce6(0x1f4)] || [])[_0x433ce6(0x19f)](_0x5860e4 => { const _0xd9e30 = _0x433ce6, _0x5b7787 = new Date(_0x5860e4); if (_0x5b7787['getMonth']() + 0x1 === _0x357181) { const _0x7e5a3f = _0x1f8761(_0x5860e4); if (!_0x2932c3[_0x7e5a3f]) _0x2932c3[_0x7e5a3f] = { 'date': _0x5b7787, 'attendance': !![], 'grades': [], 'payments': [] }; else _0x2932c3[_0x7e5a3f][_0xd9e30(0x1f4)] = !![]; } }), (_0x253029[_0x433ce6(0x19b)] || [])[_0x433ce6(0x19f)](_0x8b605f => { const _0x2822f9 = _0x433ce6, _0x2abf18 = new Date(_0x8b605f[_0x2822f9(0x29f)]); if (_0x2abf18[_0x2822f9(0x285)]() + 0x1 === _0x357181) { const _0x33dfca = _0x1f8761(_0x8b605f[_0x2822f9(0x29f)]); if (!_0x2932c3[_0x33dfca]) _0x2932c3[_0x33dfca] = { 'date': _0x2abf18, 'attendance': ![], 'grades': [], 'payments': [] }; _0x2932c3[_0x33dfca]['grades']['push'](_0x8b605f); } }), (_0x253029[_0x433ce6(0x1ff)] || [])[_0x433ce6(0x19f)](_0x3653fe => { const _0x406051 = _0x433ce6, _0x2e23ef = new Date(_0x3653fe[_0x406051(0x29f)]); if (_0x2e23ef[_0x406051(0x285)]() + 0x1 === _0x357181) { const _0x1afae0 = _0x1f8761(_0x3653fe['date']); if (!_0x2932c3[_0x1afae0]) _0x2932c3[_0x1afae0] = { 'date': _0x2e23ef, 'attendance': ![], 'grades': [], 'payments': [] }; _0x2932c3[_0x1afae0][_0x406051(0x1ff)][_0x406051(0x1e2)](_0x3653fe); } }); const _0x150e62 = Object['keys'](_0x2932c3)['sort'](), _0x5de7cb = document[_0x433ce6(0x20c)](_0x433ce6(0x264)); _0x5de7cb[_0x433ce6(0x1ba)] = _0x150e62[_0x433ce6(0x1b5)] ? _0x150e62['map'](_0x50719f => { const _0x4fa18a = _0x433ce6, _0x2c0ba2 = _0x2932c3[_0x50719f], _0x49ece9 = []; if (_0x2c0ba2[_0x4fa18a(0x1f4)]) _0x49ece9['push'](_0x4fa18a(0x2c3)); _0x2c0ba2[_0x4fa18a(0x19b)][_0x4fa18a(0x19f)](_0x47e479 => _0x49ece9['push'](_0x47e479[_0x4fa18a(0x1ac)] === 'quiz' ? _0x4fa18a(0x2d7) : _0x4fa18a(0x25b))); const _0x11a161 = _0x2c0ba2[_0x4fa18a(0x19b)][_0x4fa18a(0x230)](_0x2cb836 => '<span\x20style=\x22color:\x20#10b981;\x20font-weight:\x20bold;\x22>' + _0x2cb836[_0x4fa18a(0x1bc)] + _0x4fa18a(0x260) + _0x2cb836[_0x4fa18a(0x238)])[_0x4fa18a(0x1aa)]('<br>'), _0x89ede5 = _0x2c0ba2[_0x4fa18a(0x1ff)][_0x4fa18a(0x230)](_0x3c3773 => _0x4fa18a(0x207) + _0x3c3773['amount'] + _0x4fa18a(0x220) + (_0x3c3773['note'] ? _0x4fa18a(0x25e) + _0x3c3773[_0x4fa18a(0x2cf)] + _0x4fa18a(0x265) : '') + _0x4fa18a(0x1fe))[_0x4fa18a(0x1aa)](''); return _0x4fa18a(0x22d) + _0x2c0ba2[_0x4fa18a(0x29f)]['toLocaleDateString'](_0x4fa18a(0x1dc)) + _0x4fa18a(0x283) + (_0x49ece9[_0x4fa18a(0x1aa)]('\x20+\x20') || _0x4fa18a(0x27b)) + _0x4fa18a(0x283) + (_0x11a161 || _0x4fa18a(0x27b)) + _0x4fa18a(0x283) + (_0x89ede5 || '---') + '</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'; })[_0x433ce6(0x1aa)]('') : _0x433ce6(0x270); const _0x4cfb47 = _0x253029[_0x433ce6(0x1f4)][_0x433ce6(0x273)](_0x54a5f3 => new Date(_0x54a5f3)['getMonth']() + 0x1 === _0x357181)[_0x433ce6(0x1b5)]; document['getElementById'](_0x433ce6(0x1c2))['textContent'] = _0x4cfb47; const _0x7b3023 = (_0x253029['payments'] || [])[_0x433ce6(0x273)](_0x27f3c2 => new Date(_0x27f3c2['date'])[_0x433ce6(0x285)]() + 0x1 === _0x357181)['reduce']((_0x15e716, _0x33ec7c) => _0x15e716 + parseFloat(_0x33ec7c[_0x433ce6(0x2a3)]), 0x0); document[_0x433ce6(0x20c)](_0x433ce6(0x2ef))['textContent'] = _0x7b3023; const _0x13bc5d = document[_0x433ce6(0x20c)](_0x433ce6(0x24a)); _0x13bc5d[_0x433ce6(0x1f1)][_0x433ce6(0x193)] = _0x433ce6(0x2bb); let _0x48d369 = _0x253029[_0x433ce6(0x1f6)] ? _0x253029[_0x433ce6(0x1f6)]['replace'](/\D/g, '') : ''; _0x48d369[_0x433ce6(0x266)]('01') && (_0x48d369 = '2' + _0x48d369); const _0x2de907 = _0x433ce6(0x1e7) + _0x253029[_0x433ce6(0x257)] + _0x433ce6(0x2e2) + new Intl[(_0x433ce6(0x19c))]('ar-EG', { 'month': _0x433ce6(0x2f0) })[_0x433ce6(0x2ce)](new Date(0x7e8, _0x357181 - 0x1)) + _0x433ce6(0x19a), _0x5e7b69 = _0x433ce6(0x2f8) + _0x48d369 + _0x433ce6(0x223) + encodeURIComponent(_0x2de907); await _0x14a91d; const _0x380cdf = async () => { const _0x55abb7 = _0x433ce6; try { const _0x561876 = await html2canvas(_0x13bc5d, { 'scale': 0x2, 'useCORS': !![], 'allowTaint': ![], 'logging': !![] }); if (!_0x561876) throw new Error(_0x55abb7(0x293)); _0x561876[_0x55abb7(0x2db)](async _0x4d90bf => { const _0x3aab31 = _0x55abb7; if (!_0x4d90bf) { Modal[_0x3aab31(0x215)](_0x3aab31(0x21d), _0x3aab31(0x2d0)); return; } try { const _0x58f21a = new ClipboardItem({ [_0x4d90bf[_0x3aab31(0x1ac)]]: _0x4d90bf }); await navigator[_0x3aab31(0x2f5)]['write']([_0x58f21a]); const _0xc7bfac = await Modal['confirm']('Report\x20Ready\x20to\x20Send', _0x3aab31(0x295) + _0x3aab31(0x200) + _0x3aab31(0x1b6) + _0x3aab31(0x2dc)); if (_0xc7bfac) { const _0x162d62 = new Date()[_0x3aab31(0x2c0)](), _0x317da1 = _0x162d62 + '-' + _0x357181; if (!_0x253029[_0x3aab31(0x22a)]) _0x253029[_0x3aab31(0x22a)] = {}; _0x253029[_0x3aab31(0x22a)][_0x317da1] = new Date()['toISOString'](), saveToFirebase(), waWindowReference && !waWindowReference[_0x3aab31(0x2e1)] ? (waWindowReference[_0x3aab31(0x209)][_0x3aab31(0x2b3)] = _0x5e7b69, waWindowReference[_0x3aab31(0x1f5)]()) : waWindowReference = window['open'](_0x5e7b69, _0x3aab31(0x2f1)); } } catch (_0x46b88b) { console[_0x3aab31(0x288)]('Clipboard\x20Error:', _0x46b88b), Modal['alert'](_0x3aab31(0x290), 'Failed\x20to\x20copy\x20to\x20clipboard.\x20If\x20running\x20locally,\x20please\x20use\x20\x22Live\x20Server\x22\x20or\x20HTTPS\x20to\x20ensure\x20image\x20copying\x20works.'); } finally { _0x13bc5d[_0x3aab31(0x1f1)]['display'] = _0x3aab31(0x252); } }); } catch (_0x10d9f1) { console[_0x55abb7(0x288)](_0x55abb7(0x231), _0x10d9f1), Modal[_0x55abb7(0x215)](_0x55abb7(0x21d), _0x55abb7(0x232)), _0x13bc5d[_0x55abb7(0x1f1)][_0x55abb7(0x193)] = _0x55abb7(0x252); } }; await _0x380cdf(); } function exportToExcel() { const _0x38e335 = _0x32e985; if (!students[_0x38e335(0x1b5)]) { Modal[_0x38e335(0x215)]('Notice', 'No\x20data\x20to\x20export.'); return; } const _0x5a5e98 = students[_0x38e335(0x230)](_0x45a7e4 => ({ 'Code': _0x45a7e4['id'], 'Name': _0x45a7e4[_0x38e335(0x257)], 'Age': _0x45a7e4['age'], 'Stage': _0x45a7e4[_0x38e335(0x278)], 'Phone': _0x45a7e4[_0x38e335(0x2d8)], 'Parent\x20Phone': _0x45a7e4[_0x38e335(0x1f6)], 'Photo': _0x45a7e4['photo'] || '', 'Created\x20At': _0x45a7e4['createdAt'] || '', '_attendance': JSON[_0x38e335(0x22e)](_0x45a7e4['attendance'] || []), '_grades': JSON[_0x38e335(0x22e)](_0x45a7e4[_0x38e335(0x19b)] || []), '_payments': JSON['stringify'](_0x45a7e4[_0x38e335(0x1ff)] || []) })), _0x22e8a6 = XLSX[_0x38e335(0x1f7)][_0x38e335(0x1d5)](_0x5a5e98), _0x24f348 = XLSX[_0x38e335(0x1f7)][_0x38e335(0x2c2)](); XLSX[_0x38e335(0x1f7)][_0x38e335(0x25d)](_0x24f348, _0x22e8a6, _0x38e335(0x1e4)); const _0xf702d9 = Object[_0x38e335(0x2a9)](_0x5a5e98[0x0])['map'](_0x5354ee => ({ 'wch': Math['max'](_0x5354ee[_0x38e335(0x1b5)], 0xf) })); _0x22e8a6[_0x38e335(0x1f3)] = _0xf702d9, XLSX['writeFile'](_0x24f348, _0x38e335(0x284) + new Date()[_0x38e335(0x2f7)]()[_0x38e335(0x195)]('T')[0x0] + _0x38e335(0x2ac)); } function exportReportStatusToExcel() { const _0x3c095d = _0x32e985, _0x5d0997 = document['getElementById'](_0x3c095d(0x2ec)), _0x50b971 = _0x5d0997 ? _0x5d0997['value'] : _0x3c095d(0x21c), _0x3c17d3 = document[_0x3c095d(0x20c)](_0x3c095d(0x29c))[_0x3c095d(0x2a8)], _0x226ac4 = new Date()[_0x3c095d(0x2c0)](), _0x113447 = _0x226ac4 + '-' + _0x3c17d3, _0x3fda9e = _0x50b971 === 'all' ? students : students[_0x3c095d(0x273)](_0x311413 => _0x311413[_0x3c095d(0x278)] === _0x50b971); if (!_0x3fda9e[_0x3c095d(0x1b5)]) { Modal[_0x3c095d(0x215)]('Notice', _0x3c095d(0x2a6)); return; } const _0x316495 = new Intl[(_0x3c095d(0x19c))](_0x3c095d(0x1dc), { 'month': _0x3c095d(0x2f0) })[_0x3c095d(0x2ce)](new Date(0x7e8, _0x3c17d3 - 0x1)), _0x3c29fa = _0x3fda9e[_0x3c095d(0x230)](_0x33bfaf => { const _0x108f79 = _0x3c095d, _0x431623 = _0x33bfaf[_0x108f79(0x22a)] && _0x33bfaf['reportLog'][_0x113447]; return { 'Code': _0x33bfaf['id'], 'Name': _0x33bfaf['name'], 'Stage': _0x33bfaf[_0x108f79(0x278)], 'Parent\x20Phone': _0x33bfaf[_0x108f79(0x1f6)], 'Status': _0x431623 ? _0x108f79(0x213) : _0x108f79(0x1a0), 'Sent\x20Date': _0x431623 ? new Date(_0x33bfaf['reportLog'][_0x113447])[_0x108f79(0x2a7)](_0x108f79(0x1dc)) : '-' }; }), _0x480c39 = XLSX[_0x3c095d(0x1f7)][_0x3c095d(0x1d5)](_0x3c29fa), _0x2605d9 = XLSX[_0x3c095d(0x1f7)]['book_new'](); XLSX[_0x3c095d(0x1f7)][_0x3c095d(0x25d)](_0x2605d9, _0x480c39, _0x3c095d(0x2c4) + _0x316495); const _0x3ffe4d = [{ 'wch': 0xa }, { 'wch': 0x19 }, { 'wch': 0xf }, { 'wch': 0xf }, { 'wch': 0xf }, { 'wch': 0x14 }]; _0x480c39[_0x3c095d(0x1f3)] = _0x3ffe4d, XLSX[_0x3c095d(0x298)](_0x2605d9, _0x3c095d(0x2c4) + _0x50b971 + '_' + _0x316495 + _0x3c095d(0x2ac)); } function importFromExcel(_0x3af2ca) { const _0x317866 = _0x32e985, _0x3534dc = _0x3af2ca['files'][0x0]; if (!_0x3534dc) return; const _0xd450e6 = new FileReader(); _0xd450e6[_0x317866(0x2ba)] = async _0x2464aa => { const _0xd54508 = _0x317866; try { const _0x3f2864 = new Uint8Array(_0x2464aa[_0xd54508(0x2a4)][_0xd54508(0x1b2)]), _0x3a8ce5 = XLSX[_0xd54508(0x2e4)](_0x3f2864, { 'type': _0xd54508(0x269) }), _0x401149 = _0x3a8ce5['SheetNames'][0x0], _0xfcb438 = _0x3a8ce5[_0xd54508(0x267)][_0x401149], _0x3482bc = XLSX[_0xd54508(0x1f7)][_0xd54508(0x28f)](_0xfcb438); if (!_0x3482bc[_0xd54508(0x1b5)]) { Modal[_0xd54508(0x215)](_0xd54508(0x21d), _0xd54508(0x1db)); return; } const _0x121c66 = ['Code', _0xd54508(0x1d0), 'Age', _0xd54508(0x248), _0xd54508(0x279), _0xd54508(0x24c), _0xd54508(0x1e8), _0xd54508(0x24e), '_attendance', _0xd54508(0x1f0), _0xd54508(0x2f4)], _0x40cf39 = Object[_0xd54508(0x2a9)](_0x3482bc[0x0]), _0x1f5b34 = _0x121c66['length'] === _0x40cf39[_0xd54508(0x1b5)] && _0x121c66['every']((_0x31196e, _0x3442cf) => _0x31196e === _0x40cf39[_0x3442cf]); if (!_0x1f5b34) { Modal['alert']('Format\x20Error', _0xd54508(0x2d1)); return; } const _0x496d8e = await Modal[_0xd54508(0x1d3)](_0xd54508(0x21e), _0xd54508(0x1eb) + _0x3482bc[_0xd54508(0x1b5)] + _0xd54508(0x2b5)); if (!_0x496d8e) { _0x3af2ca[_0xd54508(0x2a8)] = ''; return; } const _0x43e46f = _0x3482bc[_0xd54508(0x230)](_0x70ed19 => { const _0x46d331 = _0xd54508; return { 'id': String(_0x70ed19['Code'] || generateID()), 'name': String(_0x70ed19[_0x46d331(0x1d0)] || _0x46d331(0x2fb)), 'age': _0x70ed19['Age'] || '', 'stage': _0x70ed19[_0x46d331(0x248)] || '', 'phone': String(_0x70ed19[_0x46d331(0x279)] || ''), 'guardianPhone': String(_0x70ed19[_0x46d331(0x24c)] || ''), 'photo': _0x70ed19[_0x46d331(0x1e8)] || '', 'createdAt': _0x70ed19[_0x46d331(0x24e)] || new Date()['toISOString'](), 'attendance': _0x70ed19[_0x46d331(0x28a)] ? JSON[_0x46d331(0x1d4)](_0x70ed19[_0x46d331(0x28a)]) : [], 'grades': _0x70ed19[_0x46d331(0x1f0)] ? JSON[_0x46d331(0x1d4)](_0x70ed19['_grades']) : [], 'payments': _0x70ed19[_0x46d331(0x2f4)] ? JSON['parse'](_0x70ed19[_0x46d331(0x2f4)]) : [] }; }); _0x43e46f[_0xd54508(0x19f)](_0x395f07 => { const _0x5c0365 = students['findIndex'](_0x4cf69e => _0x4cf69e['id'] === _0x395f07['id']); _0x5c0365 !== -0x1 ? students[_0x5c0365] = _0x395f07 : students['push'](_0x395f07); }), saveToFirebase(), displayStudentList(), Modal['alert'](_0xd54508(0x1b4), _0x43e46f['length'] + _0xd54508(0x219)); } catch (_0x492cc7) { console[_0xd54508(0x288)](_0xd54508(0x1d2), _0x492cc7), Modal[_0xd54508(0x215)](_0xd54508(0x27f), _0xd54508(0x1e9)); } finally { _0x3af2ca[_0xd54508(0x2a8)] = ''; } }, _0xd450e6[_0x317866(0x1e1)](_0x3534dc); }